Add comprehensive error handling to all functions in the codebase.

Include:
- Try-catch blocks for async operations
- Proper error types and messages
- Graceful fallbacks where appropriate
- Logging for debugging purposes

Make sure existing functionality is preserved.
